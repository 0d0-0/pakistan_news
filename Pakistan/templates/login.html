<!DOCTYPE html>
<html lang="en">
    {% load static %}
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>巴基斯坦国情小站</title>
    <link rel="stylesheet" href="../static/css/login.css" />
</head>

<body>
    <div class="container">
        <div class="form-box">
            <div class="register-box hidden">
                <h1>register</h1>
                <form method="POST" action="{% url 'login_or_register' %}">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="register">
                    <input type="text" name="username1" placeholder="用户名" required />
                    <input type="password" name="password1" placeholder="密码" required />
                    <input type="password" name="confirmpassword" placeholder="确认密码" required />
                    <button type="submit" id="registers">注册</button>    <!--还没有账号 就注册一个  点击按钮即可-->
                </form>
            </div>
            <div class="login-box">
                <h1>login</h1>
                <form method="POST" action="{% url 'login_or_register' %}">
                    {% csrf_token %}   <!--输入账号密码  点击登录-->
                    <input type="hidden" name="action" value="login">
                    <input type="text" name="username2" placeholder="用户名" required />
                    <input type="password" name="password2" placeholder="密码" required />
                    <button id="login-btn" type="submit">登录</button>
                </form>
            </div>
        </div>
        <div class="con-box left">   <!--各种小提示-->
            <h2 id="welcome-msg1">欢迎来到<br><span>巴基斯坦小站</span></h2>
            <p>已有账号</p>
            <button id="login">去登录</button>
        </div>
        <div class="con-box right">
            <h2 id="welcome-msg2">欢迎来到<br><span>巴基斯坦小站</span></h2>
            <p>没有账号？</p>
            <button id="register">去注册</button>
        </div>
    </div>
    <script>
        // 从 Django 上下文获取消息变量
        const successMessage = "{{ zhuce|safe }}";
        const errorMessage = "{{ dengru|safe }}";
        
        // 获取消息展示元素
        const welcomeMsg2 = document.getElementById('welcome-msg2');
        const welcomeMsg1 = document.getElementById('welcome-msg1');
        
        // 展示消息
        if (successMessage) {
            welcomeMsg1.innerHTML = successMessage;
            // 可能的成功消息样式
            welcomeMsg1.classList.add('success-message');
        } else if (errorMessage) {
            welcomeMsg2.innerHTML = errorMessage;
            // 可能的错误消息样式
            welcomeMsg2.classList.add('error-message');
        }
    </script>

<script>
    let login = document.getElementById("login");
    let register = document.getElementById("register");
    let form_box = document.getElementsByClassName("form-box")[0];
    let register_box = document.getElementsByClassName("register-box")[0];
    let login_box = document.getElementsByClassName("login-box")[0];

    register.addEventListener("click", () => {
        form_box.style.transform = "translateX(80%)";
        login_box.classList.add("hidden");
        register_box.classList.remove("hidden");
    });

    login.addEventListener("click", () => {
        form_box.style.transform = "translateX(0%)";
        register_box.classList.add("hidden");
        login_box.classList.remove("hidden");
    });

    // 从 Django 上下文获取 show_register 变量
    const showRegister = "{{ show_register }}";

    // 页面加载完成时，根据 show_register 状态切换到注册表单
    window.onload = () => {
        if (showRegister === "True") {
            form_box.style.transform = "translateX(80%)";
            login_box.classList.add("hidden");
            register_box.classList.remove("hidden");
        }
    };
</script>
</body>

</html>